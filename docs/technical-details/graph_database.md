# Graph Database

## Id Structure

The Id structure in our graph database follows the naming convention outlined in the `/naming-conventions/Id.md` file. Here's a brief overview:

Structure: `[Site]-[Area]-[Function]-[Type]-[Instance]`

Example: `DALLAS-PROD-OPS-TEAM-001`

Components:
- [Site]: Derived from ISA-95's Enterprise-Site hierarchy
- [Area]: Aligns with ISA-95's Area concept
- [Function]: Influenced by PERA's functional levels and Industry 4.0 concepts
- [Type]: Added to accommodate various entities, including AI agents
- [Instance]: Common in many industrial naming conventions for unique identification

## Graph Database Nodes

Our graph database consists of several types of nodes, each representing different entities in the XMPro AI Agents system. Here's an overview of the main node types and their properties:

### Artifact

| Property    | Type     | Description                                    |
|-------------|----------|------------------------------------------------|
| created_date  | DateTime | Timestamp of when the instance was created     |
| id          | String   | Unique identifier for the artifact       |
| type        | String   | The type of artifact ( `Audit` or `Conversation` or `Plan` or `Subtask` or `Tool` )|

#### `Plan` Specific properties

| Property             | Type     | Description                                              |
|----------------------|----------|----------------------------------------------------------|
| active               | Boolean  | Indicates if the plan is currently active                |
| goal                 | String  | The goal of the plan                                     |
| last_modified_date   | DateTime | Date and time when the plan was last modified            |
| pddl_domain          | String  | PDDL domain description for the plan                     |
| pddl_plan            | String  | PDDL plan generated                                      |
| pddl_problem         | String  | PDDL problem description for the plan                    |
| response             | String  | Response associated with the plan                        |
| status               | String  | Current status of the plan                               |
| timestamp            | Integer  | Timestamp of the plan                                    |
| total_api_calls      | Integer  | Total number of API calls made for the plan              |
| total_response_time  | Integer  | Total time taken for responses related to the plan       |
| total_token_usage    | Integer  | Total number of tokens used for the plan                 |

#### `Subtask` Specific Properties

| Property             | Type     | Description                                              |
|----------------------|----------|----------------------------------------------------------|
| description                 | String  | The description of the subtask                                     |
| name               | String  | The name of the subtask                |
| order   | Integer | The order of the subtask            |

#### `Tool` Specific Properties

| Property       | Type     | Description                                        |
|----------------|----------|----------------------------------------------------|
| input          | String  | Input provided to the tool                         |
| name           | String   | The name of the tool                               |
| result         | String  | Result generated by the tool                     |
| success        | Boolean  | Indicates if the tool was successful   |

---

### AgentInstance

| Property           | Type     | Description                                    |
|--------------------|----------|------------------------------------------------|
| agent_id           | String   | Unique identifier for the agent instance       |
| created_date       | DateTime | Timestamp of when the instance was created     |
| last_modified_date | DateTime | Timestamp of when the instance was last modified |
| name               | String   | Name of the agent instance                     |
| plan_prompt        | String   | The prompt used for planning                   |
| profile_id         | String   | Id of the associated agent profile             |
| type               | String   | The type of agent instance                     |
| user_prompt        | String   | The initial prompt given to the agent instance |

---

### AgentProfile

| Property                | Type             | Description                                           |
|-------------------------|------------------|-------------------------------------------------------|
| active                  | Boolean          | Indicates if the profile is currently active          |
| allowed_planning_method | Array of Strings | List of planning methods available to this agent profile|
| category                | String           | Category of the prompt                                |
| created_date            | DateTime         | Timestamp of when the profile was created             |
| decision_parameters     | String (JSON)    | Parameters for decision making                        |
| deontic_rules           | Array of Strings | Rules governing the agent's behavior                  |
| experience              | String           | Description of the agent's simulated experience       |
| interaction_preferences | String (JSON)    | Preferences for interaction                           |
| last_modified_date      | DateTime         | Timestamp of when the profile was last modified       |
| max_tokens              | Integer          | Maximum number of tokens for responses                |
| memory_parameters       | String (JSON)    | Parameters for memory management                      |
| model_name              | String           | Name of the specific AI model                         |
| model_provider          | String           | Provider of the AI model used                         |
| name                    | String           | Name of the agent profile                             |
| observation_prompt      | String           | Prompt template for observations                      |
| organizational_rules    | Array of Strings | Rules specific to the organization                    |
| performance_metrics     | String (JSON)    | Metrics for measuring performance                     |
| profile_id              | String           | Unique identifier for the agent profile               |
| rag_collection_name     | String           | Name of the RAG collection used                       |
| rag_top_k               | Integer          | Number of top results to retrieve from RAG            |
| rag_vector_size         | Integer          | Size of the vector for RAG                            |
| reflection_prompt       | String           | Prompt template for reflections                       |
| skills                  | Array of Strings | List of skills the agent possesses                    |
| system_prompt           | String           | The system prompt for the agent                       |
| tags                    | Array of Strings | Tags associated with the prompt                       |
| use_general_rag         | Boolean          | Whether to use general RAG or not                     |

---

### Decision

| Property         | Type     | Description                                               |
|------------------|----------|-----------------------------------------------------------|
| created_date     | DateTime | Date and time when the observation was created            |
| decision_id      | String  | Unique identifier for the decision                        |
| goal             | String  | The goal of the observation                               |
| max_tokens       | Integer          | Maximum number of tokens for responses                |
| model_name       | String           | Name of the specific AI model                         |
| model_provider   | String           | Provider of the AI model used                         |
| reasoning        | String  | Reasoning behind the observation                          |
| response_time    | String  | Time taken to generate the observation                    |
| selected_method  | String  | Method selected for the observation                       |
| timestamp        | Integer  | Timestamp of the observation                              |
| token_usage      | Integer  | Number of tokens used in generating the observation       |
| trigger_context  | String  | Context that triggered the observation                    |
| trigger_reason   | String  | Reason for triggering the observation                     |
| trigger_response | String  | Response to the trigger                                   |
| type             | String   | Type of the artifact ( `Observation` or `Planning` )  |

#### `Planning` Specific Properties

| Property         | Type     | Description                                               |
|------------------|----------|-----------------------------------------------------------|
| goals_prompt     | Unknown  | Prompt used to generate goals                             |
| goals_response   | Unknown  | Response containing generated goals                       |
| resulting_id     | Unknown  | Identifier resulting from the planning decision           |

---

### Entry

| Property        | Type     | Description                                              |
|-----------------|----------|----------------------------------------------------------|
| created_date    | DateTime | Date and time when the entry was created    |
| id              | String   | Unique identifier for the entry |
| timestamp       | Integer  | Timestamp of the entry                      |
| type            | String   | Type of the entry ( `Audit` or `Conversation` or `Planning` or `Tool` or `ToolLLM` )   |

#### `Audit` Specific Properties

| Property        | Type     | Description                                              |
|-----------------|----------|----------------------------------------------------------|
| change          | String   | The change that was made                                 |
| user            | String   | The user making the entry                                |

#### `Conversation` Specific Properties

| Property        | Type     | Description                                              |
|-----------------|----------|----------------------------------------------------------|
| prompt          | String  | The prompt used                       |
| rag_query_time  | Integer  | Time taken for RAG (Retrieval-Augmented Generation) query|
| response        | String  | The response generated                |
| response_time   | Integer  | Time taken to generate the response                      |
| summary         | String  | Summary                               |
| timestamp       | Integer  | Timestamp of the entry                      |
| token_usage     | Integer  | Number of tokens used                 |
| user_query      | String  | The query provided by the user                           |

#### `Planning` Specific Properties

| Property        | Type     | Description                                              |
|-----------------|----------|----------------------------------------------------------|
| name            | String  | Name of the planning entry                               |
| prompt          | String  | The prompt used                       |
| rag_query_time  | Integer  | Time taken for RAG (Retrieval-Augmented Generation) query|
| response        | String  | The response generated                |
| response_time   | Integer  | Time taken to generate the response                      |
| timestamp       | Integer  | Timestamp of the entry                      |
| token_usage     | Integer  | Number of tokens used                 |

#### `Tool` Specific Properties

| Property       | Type     | Description                                        |
|----------------|----------|----------------------------------------------------|
| additional_data | String  | The amount of data processed   |
| attempt_number | Integer   | The attempt number for the tool                  |
| data_processed | Integer  | The amount of data processed   |
| response_time  | Integer  | Time taken for response       |
| result         | String  | Result generated by the tool                     |
| success        | Boolean  | Indicates if the tool was successful   |

#### `ToolLLM` Specific Properties

| Property       | Type     | Description                                        |
|----------------|----------|----------------------------------------------------|
| max_tokens     | Integer          | Maximum number of tokens for responses                |
| model_name     | String           | Name of the specific AI model                         |
| model_provider | String           | Provider of the AI model used                         |
| prompt         | Integer  | The prompt used  |
| response       | String  | The response generated                |
| response_time  | Integer  | Time taken to generate the response                      |
| token_usage    | Integer  | Number of tokens used                 |

---

### Library

| Property     | Type     | Description                            |
|--------------|----------|---------------------------------|
| created_date | DateTime | Date and time when the library was created   |
| name         | String   | Name of the library           |
| type         | String   | Type of the library ( `Prompt` or `Tool` )   |

---

### Memory

| Property       | Type     | Description                                                    |
|----------------|----------|----------------------------------------------------------------|
| created_date   | DateTime | Timestamp of when the memory was created |
| id             | String   | Unique identifier for the memory |
| importance     | Float    | Importance score of the memory  |
| last_accessed  | DateTime | Timestamp of when the memory was last accessed |
| prompt         | String   | The prompt or content associated with this memory              |
| rag_query_time | Float    | Time taken for RAG query                             |
| response       | String   | The response content                                           |
| response_time  | Float    | Time taken for the response           |
| timestamp      | Integer  | Unix timestamp                               |
| token_usage    | Integer  | Number of tokens used                               |
| type           | String   | Type of memory ( `Observation` or `Reflection` )                              |

---

### Metrics

| Property               | Type     | Description                                           |
|------------------------|----------|-------------------------------------------------------|
| average_response_time  | Float    | Average time taken for responses                      |
| created_date           | DateTime | Timestamp of when the aggregate was created           |
| failed_calls           | Integer  | Number of failed calls                                |
| id                     | Integer  | Unique identifier for the aggregate                   |
| last_modified_date     | DateTime | Timestamp of when the aggregate was last modified     |
| successful_calls       | Integer  | Number of successful calls                            |
| total_calls            | Integer  | Total number of calls made                            |
| total_data_processed   | Integer  | Total amount of data processed                        |
| total_response_time    | Float    | Total time taken for all responses                    |
| type                   | String   | Type of the metrics ( `Aggregate` )          |

---

### Prompt

| Property           | Type             | Description                                           |
|--------------------|------------------|-------------------------------------------------------|
| access_level       | String           | Access level required to use or modify the prompt     |
| active             | Boolean          | Whether the prompt is currently active                |
| author             | String           | Author of the prompt                                  |
| category           | String           | Category of the prompt                                |
| created_date       | DateTime         | Date and time when the prompt was created             |
| description        | String           | Description of the prompt's purpose                   |
| internal_name      | String           | Internal name used for backend operations (indexed)   |
| last_modified_date | DateTime         | Date and time of the last modification                |
| max_tokens         | Integer          | Maximum number of tokens for responses                |
| model_name         | String           | Specific AI model the prompt is optimized for         |
| model_provider     | String           | Provider of the AI model the prompt is designed for   |
| name               | String           | Name of the prompt                                    |
| prompt             | String           | The actual prompt text                                |
| prompt_id          | String           | Unique identifier for the prompt                      |
| reserved_fields    | Array of Strings | Fields reserved for specific use in the prompt        |
| tags               | Array of Strings | Tags associated with the prompt                       |
| type               | String           | The type of prompt                       |
| version            | Integer          | Version number of the prompt (indexed)                |

---

### System Options

| Property                      | Type             | Description                                           |
|-------------------------------|------------------|-------------------------------------------------------|
| created_date                  | DateTime         | Date and time when the options were created           |
| id                            | String           | Unique identifier for the system options              |
| last_modified_date            | DateTime         | Date and time of the last modification                |
| models_providers              | Array of Strings | List of model providers                               |
| prompt_access_levels          | JSON String      | List of access levels with values and descriptions    |
| prompt_types                  | JSON String      | List of prompt types with values and descriptions     |
| rag_schema                    | JSON String | List of the RAG collection schemas used                      |
| reserved_fields_observation   | Array of Strings | Fields reserved for observations                      |
| reserved_fields_reflection    | Array of Strings | Fields reserved for reflections                       |

---

### Team

| Property                  | Type             | Description |
|---------------------------|------------------|----------------------------------------------------------------|
| author                    | String           | Author of the team |
| communication_protocol    | JSON String      | Details of communication channels, frequencies, and reporting schedules |
| compliance_requirements   | Array of Strings | List of regulatory compliance standards |
| created_date              | DateTime         | Date and time when the team was created |
| decision_making           | JSON String      | List of decision-making protocols with methods and applicable scenarios |
| description               | String           | Brief description of the team's purpose |
| escalation_policy         | JSON String      | Detailed policy for handling escalations, including conditions and actions |
| id                        | Integer          | Unique identifier for the team |
| last_modified_date        | DateTime         | Date and time of the last modification |
| name                      | String           | Name of the team |
| objectives                | Array of Strings | List of team objectives |
| operational_constraints   | JSON String      | Operational limits and parameters for the team's activities |
| performance_metrics       | JSON String      | Key performance indicators with targets and weights |
| team_id                   | String           | Unique identifier for the team within the organization |
| version                   | String           | Version number of the team configuration |

---

### Tool

| Property           | Type     | Description |
|--------------------|----------|-------------------------------------------------------------------------------------------|
| class_name         | String   | The class name of the tool |
| created_date       | DateTime | Date and time when the tool was created |
| description        | String   | A brief description of the tool's functionality |
| id                 | Integer  | Unique identifier for the tool |
| last_modified_date | DateTime | Date and time of the last modification |
| max_tokens         | Integer  | The maximum number of tokens the tool can process (if applicable) |
| model_name         | String   | The name of the model used by the tool (if applicable) |
| model_provider     | String   | The provider of the model (if applicable) |
| name               | String   | The name of the tool |
| options            | String   | Additional options for the tool (empty in this case) |
| prompt_system      | String   | The system prompt used by the tool (if applicable) |
| prompt_user        | String   | The prompt used by the tool (if applicable) |
| reserved_fields    | Array of Strings | Fields reserved for the user prompt |

This graph structure allows for efficient querying and analysis of the relationships between different entities in the XMPro AI Agents system.